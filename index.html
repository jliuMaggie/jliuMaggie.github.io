<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¯æ—¥è´¢ç»è¦é—»</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">

<header class="bg-white shadow py-4 px-6">
  <div class="max-w-5xl mx-auto flex justify-between items-center">
    <h1 class="text-xl font-bold text-gray-800">ğŸ“ˆ æ¯æ—¥å®æ—¶è´¢ç»è¦é—»</h1>
    <button id="refresh" class="text-blue-600 text-sm">
      <i class="fa fa-refresh"></i> åˆ·æ–°
    </button>
  </div>
</header>

<div class="max-w-5xl mx-auto py-6 px-6">
  <div id="status" class="text-sm text-gray-500 mb-3">åŠ è½½ä¸­...</div>
  <div id="news-list" class="space-y-4"></div>
</div>

<script>
const API = "https://doubao-api-proxy.jliu0721.workers.dev";

function getToday() {
  const now = new Date();
  return now.toLocaleDateString('zh-CN');
}

async function loadTodayNews() {
  const today = getToday();
  document.getElementById("status").innerText = "æ­£åœ¨è·å– " + today + " å®æ—¶è´¢ç»æ–°é—»â€¦";
  document.getElementById("news-list").innerHTML = `<div class="py-10 text-center text-gray-400"><i class="fa fa-spinner fa-spin"></i></div>`;

  try {
    const prompt = `
è¯·ã€å®æ—¶è”ç½‘æœç´¢ã€‘${today} æœ€æ–°è´¢ç»è¦é—»ï¼Œ
æŒ‰ç…§é‡è¦ç¨‹åº¦æ’åºï¼Œè¾“å‡º5-8æ¡ï¼Œ
æ¯æ¡åŒ…å«ï¼š
1. æ ‡é¢˜
2. ä¸€å¥è¯æ‘˜è¦
3. å½±å“ï¼ˆç®€çŸ­ï¼‰
4. æ–°é—»å‡ºå¤„é“¾æ¥
æ ¼å¼æ¸…æ™°ï¼Œé€‚åˆæ–°é—»ç½‘ç«™å±•ç¤ºã€‚`;

    const r = await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question: prompt })
    });

    const data = await r.json();
    document.getElementById("status").innerText = `${today} å®æ—¶è´¢ç»è¦é—»ï¼ˆå·²æŒ‰é‡è¦åº¦æ’åºï¼‰`;

    const html = data.answer.split("\n").filter(line => line.trim()).map(line => `
      <div class="bg-white p-4 rounded-lg shadow">
        ${line.replace(/^-/g, "â€¢").replace(/##/g, "").replace(/###/g, "")}
      </div>
    `).join("");

    document.getElementById("news-list").innerHTML = html;

  } catch (e) {
    document.getElementById("news-list").innerHTML = `<div class="text-red-500">åŠ è½½å¤±è´¥</div>`;
    console.error(e);
  }
}

document.addEventListener("DOMContentLoaded", () => {
  loadTodayNews();
  document.getElementById("refresh").onclick = loadTodayNews;
});
</script>
</body>
</html>
